[tox]
envlist = unit
skipsdist = true

[testenv:unit]
deps =
    pytest
    -r{toxinidir}/requirements.txt
setenv =
    DATABASE_URI = {env:DATABASE_URI_TESTS}
    SECRET_KEY = test
commands =
    pytest {posargs:tests}

[testenv:migrations]
deps =
    alembic-autogen-check
    -r{toxinidir}/requirements.txt
setenv =
    DATABASE_URI = {env:DATABASE_URI_MIGRATIONS}
    SECRET_KEY = migrations
commands =
    alembic upgrade head
    alembic-autogen-check
    alembic downgrade base
    alembic upgrade head
